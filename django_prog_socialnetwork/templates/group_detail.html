{% extends 'base.html' %}

{% block content %}
<h1 class="text-2xl font-bold">{{ group.name }}</h1>
<p>{{ group.description }}</p>

<h2 class="text-xl mt-4 mb-2">Post del Gruppo</h2>
<ul>
    {% for post in posts %}
    <li class="border p-2 mb-2 rounded">
        <strong>{{ post.author.username }}</strong>: {{ post.content }}
        <small class="block text-gray-500">{{ post.created_at }}</small>

        {% if user|is_moderator:group or user == post.author %}
        <form method="post" action="{% url 'delete_post' post.id %}" class="mt-2">
            {% csrf_token %}
            <button type="submit" class="text-red-600">Elimina</button>
        </form>
        {% endif %}
    </li>
    {% empty %}
    <li>Nessun post ancora.</li>
    {% endfor %}
</ul>

<a href="{% url 'create_post' group.id %}" class="mt-4 inline-block bg-blue-500 text-white py-2 px-4 rounded">Scrivi un Post</a>

<h2 class="text-xl mt-6 mb-2">Membri</h2>
<ul>
    {% for membership in group.groupmembership_set.all %}
    <li>
        {{ membership.user.username }}
        {% if membership.is_moderator %} <strong>(Moderatore)</strong> {% endif %}

        {% if user|is_moderator:group and membership.user != user %}
        <form method="post" action="{% url 'remove_user' group.id membership.user.id %}" class="inline ml-2">
            {% csrf_token %}
            <button type="submit" class="text-red-600 text-sm">Rimuovi</button>
        </form>
        {% endif %}
    </li>
    {% endfor %}
</ul>

{% endblock %}
